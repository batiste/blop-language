
def render(text) {
  <h1>text</h1>
}

def level1() {
  i = 0
  <div>
    def add() {
      i := i + 1
      <span>i</span>
    }
    add()
    add()
    add()
  </div>
}

// should produce no warning
def testConditions() {
  if true {
    if false {
      <div>1</div>
    } elseif 1 {
      <div>2</div>
    } else {
      <div>3</div>
    }
  } elseif 1 {
    <div>4</div>
  } else {
    <div>5</div>
  }
}

test('virtual node', () => {
  test = render('hello')
  expect(test.children[0].text).toBe('hello')
})

test('test conditional virtual node', () => {
  condition = testConditions()
  expect(condition.children[0].text).toBe(2)
})

test('function inside virtual node', () => {
  test = level1()
  expect(test.children[0].children[0].text).toBe(1)
  expect(test.children[1].children[0].text).toBe(2)
  expect(test.children[2].children[0].text).toBe(3)
})