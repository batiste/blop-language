import create from './lib/state.js'
import { mount } from 'blop'
import { TodoList } from './TodoList.blop'
import { proxiedState } from './state.blop'

firstRender = true

render = () => {
  if !proxiedState.hasChanged() && !firstRender {
    return
  }
  firstRender := false
  tree = TodoList(proxiedState)
  proxiedState.flush()
  return tree
}

{ refresh, init } = mount(document.body, render)
init()

proxiedState.connect((path) => {
  console.log('change on 'path'')
  refresh()
})

